# Project Ruggaurd Bot

A Twitter (X) bot that monitors replies for "@projectruggaurd riddle me this," analyzes the original tweet's author, and posts a trustworthiness report. Developed for deployment on Replit, this project showcases a modular design to handle Twitter API interactions under free-tier constraints.

## Table of Contents
- [Project Overview](#project-overview)
- [Development Process](#development-process)
  - [Roadmap](#roadmap)
  - [Challenges and Fixes](#challenges-and-fixes)
- [Setup and Installation](#setup-and-installation)
  - [Prerequisites](#prerequisites)
  - [Steps](#steps)
- [How to Run the Bot](#how-to-run-the-bot)
- [Bot Architecture](#bot-architecture)
- [Dependencies](#dependencies)
- [Testing and Limitations](#testing-and-limitations)
  - [Hardcoded Elements for Testing](#hardcoded-elements-for-testing)
  - [Free-Tier API Limitations](#free-tier-api-limitations)
- [Replit Readiness](#replit-readiness)
- [Potential Issues for Cloners and Solutions](#potential-issues-for-cloners-and-solutions)
- [Notes](#notes)

## Project Overview
The Ruggaurd Bot is designed to enhance Twitter community trust by analyzing user accounts and vouching for their credibility. It listens for replies containing "@projectruggaurd riddle me this," fetches the original tweet, analyzes the author's account (age, followers, bio, engagement), checks for vouching by trusted accounts, and posts a detailed report. The bot is signed with `Generated by @_kosisochuk kbv1.0` for identification.

## Development Process

### Roadmap
- **Initial Phase (Planning)**: Defined the bot's core functionality—trigger detection, account analysis, vouching, and reporting.
- **Development Phase**: Built modular Python scripts using `tweepy` for Twitter API v2 integration, starting with local testing.
- **Testing Phase**: Implemented simulation mode with hardcoded data due to API limits, refining logic iteratively.
- **Deployment Phase**: Prepared for Replit deployment, updating Callback URI and ensuring live data usage.
- **Short-Term Goals**: Replace mock data with real API calls post-rate limit resets or with a paid tier.
- **Medium-Term Goals**: Dynamically fetch trusted accounts from a source like GitHub.
- **Long-Term Goals**: Add sentiment analysis and enhance error recovery.

### Challenges and Fixes
- **Rate Limits (`429 Too Many Requests`)**: Free-tier limits (e.g., 300 user lookups per 15 minutes) blocked real-time testing. Fixed by implementing simulation mode with mock objects (`MockTweet`, `MockOriginalTweet`) and hardcoded analysis data.
- **Permissions (`403 Forbidden`)**: Initial inability to post tweets due to insufficient permissions. Fixed by setting "Read and write and Direct messages" in the Twitter Developer Portal and regenerating tokens.
- **Callback URI Issues**: Local testing failed with `http://localhost` due to Twitter requiring a live URL. Resolved by using Replit’s live URL for deployment.
- **Dynamic Data Fetching**: Hardcoded trusted IDs limited flexibility. Addressed by adding dynamic ID fetching with a fallback to hardcoded values if API calls fail.

## Setup and Installation

### Prerequisites
- A Twitter Developer account with API access (free tier).
- A Replit account (free tier).

### Steps
1. **Create a Replit Project**
   - Visit [Replit](https://replit.com/), sign in, and click "Create Replit."
   - Select "Python" and name it (e.g., `project-ruggaurd-bot`).

2. **Upload Files**
   - Upload all files from this repository:
     - `main.py`
     - `config.py`
     - `trigger_listener.py`
     - `account_analyzer.py`
     - `trusted_accounts.py`
     - `reply_system.py`
     - `get_user_id.py`
     - `test_tweet.py`
     - `requirements.txt`
     - `processed.txt` (empty initially)
   - Drag-and-drop into the Replit file explorer.

3. **Configure Twitter API Keys**
   - Obtain keys from the [Twitter Developer Portal](https://developer.twitter.com/):
     - API Key
     - API Secret Key
     - Access Token
     - Access Token Secret
   - In Replit, go to the "Secrets" tab (lock icon).
   - Add as environment variables:
     - `API_KEY`: (your API Key)
     - `API_SECRET_KEY`: (your API Secret Key)
     - `ACCESS_TOKEN`: (your Access Token)
     - `ACCESS_TOKEN_SECRET`: (your Access Token Secret)

4. **Update Callback URI**
   - Run the Replit project and copy the generated URL (e.g., `https://project-ruggaurd-bot.yourusername.repl.co`).
   - In the Twitter Developer Portal, edit your app’s settings, set the **Callback URI** to this URL, and save.
   - Regenerate tokens if prompted.

5. **Install Dependencies**
   - Replit auto-installs `tweepy` and `requests` from `requirements.txt` on run.

## How to Run the Bot
1. Open `main.py` in the Replit editor.
2. Click the green "Run" button.
3. The bot checks for "@projectruggaurd riddle me this" replies every 5 minutes, posting reports.
   - If no triggers are found, it waits for live data (simulation is commented out).
   - On errors (e.g., rate limits), it waits 10 minutes before retrying.

To stop, click the red "Stop" button.

## Bot Architecture
- **`main.py`**: Orchestrates the bot loop, handles errors, and integrates modules.
- **`config.py`**: Manages API credentials via environment variables.
- **`trigger_listener.py`**: Detects trigger replies and tracks processed IDs.
- **`account_analyzer.py`**: Analyzes account metrics using API v2 (with fallback mock data).
- **`trusted_accounts.py`**: Fetches and checks trusted IDs, with dynamic loading.
- **`reply_system.py`**: Generates and posts reports.
- **`get_user_id.py`**: Utility to fetch user IDs during setup.
- **`test_tweet.py`**: Tests tweet posting functionality.

## Dependencies
- `tweepy`: For Twitter API v2 interaction.
- `requests`: For potential future external data fetching (not currently used).

## Testing and Limitations

### Hardcoded Elements for Testing
- **Mock Objects**: `MockTweet` and `MockOriginalTweet` in `main.py` were used to simulate triggers and tweets, bypassing `429` errors.
- **Mocked Analysis**: `account_analyzer.py` initially returned hardcoded metrics (e.g., 365 days, 1000 followers) to test reporting.
- **Mocked Vouching**: `trusted_accounts.py` mocked vouching with 3 trusted followers to validate logic.
- These were temporary workarounds, replaced with real API calls for deployment, with fallbacks commented for reuse if limits persist.

### Free-Tier API Limitations
- **Rate Limits**: 300 user lookups and 180 tweet searches per 15 minutes (as of June 10, 2025, 08:19 AM WAT) restricted live testing.
- **Access Restrictions**: Free tier limits tweet retrieval to the bot’s own tweets, necessitating simulation.
- **Permission Delays**: Changes in the Developer Portal (e.g., permissions) took time to propagate, causing `403` errors until resolved.

## Replit Readiness
- **Deployment Setup**: Configured for Replit with environment variables in the "Secrets" tab.
- **Live URL**: The Callback URI issue is resolved using Replit’s public URL (e.g., `https://project-ruggaurd-bot.yourusername.repl.co`), updated in the Developer Portal.
- **Auto-Installation**: `requirements.txt` ensures dependencies are installed on run.
- **Testing**: Run `main.py` and test with "@projectruggaurd riddle me this" replies. Use `test_tweet.py` to verify posting.

## Potential Issues for Cloners and Solutions
- **API Key Misconfiguration**: Authentication errors if keys are missing or mismatched. Verify all four keys in "Secrets" match the Developer Portal.
- **Rate Limits**: `429` errors due to free-tier limits. Wait 15 minutes for resets or re-enable commented mock data in `main.py`.
- **Permissions**: `403 Forbidden` if permissions are incorrect. Set "Read and write and Direct messages" in the Developer Portal and regenerate tokens.
- **Callback URI**: Must match Replit’s URL. Update it after running the project and save in the Portal.
- **File Permissions**: `processed.txt` may need manual creation if missing. Ensure it’s empty initially.

## Notes
- **Signature**: All reports include `Generated by @_kosisochuk kbv1.0`.
